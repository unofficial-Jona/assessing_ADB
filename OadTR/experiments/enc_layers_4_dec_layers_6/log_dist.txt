python custom_experiments.py
lr:0.0001
batch_size:256
weight_decay:0.0001
epochs:11
resize_feature:False
lr_drop:20
clip_max_norm:1.0
dataparallel:False
removelog:False
version:v3
query_num:8
decoder_layers:6
decoder_embedding_dim:1024
decoder_embedding_dim_out:1024
decoder_attn_dropout_rate:0.1
decoder_num_heads:4
classification_pred_loss_coef:0.5
enc_layers:64
lr_backbone:0.0001
feature:Anet2016_feature_v2
dim_feature:4096
patch_dim:1
embedding_dim:1024
num_heads:8
num_layers:4
attn_dropout_rate:0.1
positional_encoding_type:learned
hidden_dim:4096
dropout_rate:0.1
numclass:4
classification_x_loss_coef:0.3
classification_h_loss_coef:1
similar_loss_coef:0.1
margin:1.0
dataset_file:../../../pvc-meteor/features/METEOR_info.json
frozen_weights:None
thumos_data_path:/home/dancer/mycode/Temporal.Online.Detection/Online.TRN.Pytorch/preprocess/
thumos_anno_path:data/thumos_{}_anno.pickle
remove_difficult:False
device:cuda
binary_label:False
output_dir:models/experiments/enc_layers_4_dec_layers_6
seed:20
resume:
start_epoch:1
eval:False
num_workers:8
use_frequent:True
use_infrequent:False
world_size:1
dist_url:tcp://127.0.0.1:12342
all_class_name:['OverTaking', 'LaneChange', 'WrongLane', 'Cutting']
distributed:False
number of params: 117681160
(4, 181947)
(4, 181947)
[Epoch-1] [IDU-Anet2016_feature_v2] mAP: 0.2104 cAP: 0.6499

dec_mAP all together: | 0.20558941499032124 |.
dec_mAP_pred | 0 : 0.20693358598918354 |.
dec_mAP_pred | 1 : 0.20663843067650628 |.
dec_mAP_pred | 2 : 0.2062867871293841 |.
dec_mAP_pred | 3 : 0.20583436566547875 |.
dec_mAP_pred | 4 : 0.20537150945575752 |.
dec_mAP_pred | 5 : 0.20504972241683195 |.
dec_mAP_pred | 6 : 0.2047745130945406 |.
dec_mAP_pred | 7 : 0.20446153226888225 |.
all decoder map: | 0.2057 |.
OverTaking: ap = 0.6146, cap = 0.7799
LaneChange: ap = 0.1224, cap = 0.5906
WrongLane: ap = 0.0277, cap = 0.4483
Cutting: ap = 0.0771, cap = 0.7809
(4, 181947)
(4, 181947)
[Epoch-2] [IDU-Anet2016_feature_v2] mAP: 0.1964 cAP: 0.6433

dec_mAP all together: | 0.1955478113025019 |.
dec_mAP_pred | 0 : 0.1965537237063799 |.
dec_mAP_pred | 1 : 0.1962350300369709 |.
dec_mAP_pred | 2 : 0.19608186265690664 |.
dec_mAP_pred | 3 : 0.19579353089549734 |.
dec_mAP_pred | 4 : 0.19547759562298722 |.
dec_mAP_pred | 5 : 0.19525063960936243 |.
dec_mAP_pred | 6 : 0.19502672593752055 |.
dec_mAP_pred | 7 : 0.19475923466032696 |.
all decoder map: | 0.1956 |.
OverTaking: ap = 0.5927, cap = 0.7661
LaneChange: ap = 0.0926, cap = 0.5192
WrongLane: ap = 0.0452, cap = 0.5538
Cutting: ap = 0.0551, cap = 0.7342
(4, 181947)
(4, 181947)
[Epoch-3] [IDU-Anet2016_feature_v2] mAP: 0.2080 cAP: 0.6682

dec_mAP all together: | 0.2061685621245773 |.
dec_mAP_pred | 0 : 0.2068205131754513 |.
dec_mAP_pred | 1 : 0.20677186223840008 |.
dec_mAP_pred | 2 : 0.20661448837988075 |.
dec_mAP_pred | 3 : 0.20648766616219907 |.
dec_mAP_pred | 4 : 0.2062130151355605 |.
dec_mAP_pred | 5 : 0.2059463473914508 |.
dec_mAP_pred | 6 : 0.2056549481930651 |.
dec_mAP_pred | 7 : 0.20535203029511204 |.
all decoder map: | 0.2062 |.
OverTaking: ap = 0.5446, cap = 0.7257
LaneChange: ap = 0.1154, cap = 0.5771
WrongLane: ap = 0.0618, cap = 0.6195
Cutting: ap = 0.1101, cap = 0.7507
(4, 181947)
(4, 181947)
[Epoch-4] [IDU-Anet2016_feature_v2] mAP: 0.1921 cAP: 0.6295

dec_mAP all together: | 0.1897206436833642 |.
dec_mAP_pred | 0 : 0.19043901628254584 |.
dec_mAP_pred | 1 : 0.19026196155790404 |.
dec_mAP_pred | 2 : 0.19008487218086806 |.
dec_mAP_pred | 3 : 0.18995783022578913 |.
dec_mAP_pred | 4 : 0.18977957210826255 |.
dec_mAP_pred | 5 : 0.18960117251068084 |.
dec_mAP_pred | 6 : 0.18937377346208648 |.
dec_mAP_pred | 7 : 0.1892326925538878 |.
all decoder map: | 0.1898 |.
OverTaking: ap = 0.5691, cap = 0.7482
LaneChange: ap = 0.0892, cap = 0.5092
WrongLane: ap = 0.0529, cap = 0.5874
Cutting: ap = 0.0571, cap = 0.6731
(4, 181947)
(4, 181947)
[Epoch-5] [IDU-Anet2016_feature_v2] mAP: 0.1822 cAP: 0.5997

dec_mAP all together: | 0.17944113025984026 |.
dec_mAP_pred | 0 : 0.18008554494991497 |.
dec_mAP_pred | 1 : 0.17995179082282148 |.
dec_mAP_pred | 2 : 0.1798025219789568 |.
dec_mAP_pred | 3 : 0.17954890048242048 |.
dec_mAP_pred | 4 : 0.1793881086507064 |.
dec_mAP_pred | 5 : 0.17922971739277746 |.
dec_mAP_pred | 6 : 0.1791025211956593 |.
dec_mAP_pred | 7 : 0.17887468320631564 |.
all decoder map: | 0.1795 |.
OverTaking: ap = 0.5534, cap = 0.7372
LaneChange: ap = 0.0908, cap = 0.5126
WrongLane: ap = 0.0455, cap = 0.5562
Cutting: ap = 0.0391, cap = 0.5928
(4, 181947)
(4, 181947)
[Epoch-6] [IDU-Anet2016_feature_v2] mAP: 0.1851 cAP: 0.6286

dec_mAP all together: | 0.18304594366865168 |.
dec_mAP_pred | 0 : 0.18398180977422426 |.
dec_mAP_pred | 1 : 0.18375658768893202 |.
dec_mAP_pred | 2 : 0.18349558876208116 |.
dec_mAP_pred | 3 : 0.18334061417863196 |.
dec_mAP_pred | 4 : 0.18301786123346594 |.
dec_mAP_pred | 5 : 0.18273020478994295 |.
dec_mAP_pred | 6 : 0.1825045582305835 |.
dec_mAP_pred | 7 : 0.1821633542710926 |.
all decoder map: | 0.1831 |.
OverTaking: ap = 0.5576, cap = 0.7383
LaneChange: ap = 0.0956, cap = 0.5273
WrongLane: ap = 0.0498, cap = 0.5796
Cutting: ap = 0.0376, cap = 0.6693
(4, 181947)
(4, 181947)
[Epoch-7] [IDU-Anet2016_feature_v2] mAP: 0.1713 cAP: 0.6005

dec_mAP all together: | 0.16935148943819534 |.
dec_mAP_pred | 0 : 0.16994474798573356 |.
dec_mAP_pred | 1 : 0.1697047454885698 |.
dec_mAP_pred | 2 : 0.16963292025315518 |.
dec_mAP_pred | 3 : 0.1695077606041809 |.
dec_mAP_pred | 4 : 0.16928108276125609 |.
dec_mAP_pred | 5 : 0.16927690755615984 |.
dec_mAP_pred | 6 : 0.16903501435219032 |.
dec_mAP_pred | 7 : 0.1688732985772722 |.
all decoder map: | 0.1694 |.
OverTaking: ap = 0.5217, cap = 0.7121
LaneChange: ap = 0.0953, cap = 0.5265
WrongLane: ap = 0.0466, cap = 0.5674
Cutting: ap = 0.0215, cap = 0.5961
(4, 181947)
(4, 181947)
[Epoch-8] [IDU-Anet2016_feature_v2] mAP: 0.1766 cAP: 0.6058

dec_mAP all together: | 0.17380160508217335 |.
dec_mAP_pred | 0 : 0.17440899746203253 |.
dec_mAP_pred | 1 : 0.17429194367785264 |.
dec_mAP_pred | 2 : 0.17415340380563124 |.
dec_mAP_pred | 3 : 0.17402575246145818 |.
dec_mAP_pred | 4 : 0.17381098685900956 |.
dec_mAP_pred | 5 : 0.1735298662830884 |.
dec_mAP_pred | 6 : 0.1734269092856924 |.
dec_mAP_pred | 7 : 0.17327476639642161 |.
all decoder map: | 0.1739 |.
OverTaking: ap = 0.5458, cap = 0.7322
LaneChange: ap = 0.0879, cap = 0.5051
WrongLane: ap = 0.0508, cap = 0.5727
Cutting: ap = 0.0220, cap = 0.6132
(4, 181947)
(4, 181947)
[Epoch-9] [IDU-Anet2016_feature_v2] mAP: 0.1693 cAP: 0.5990

dec_mAP all together: | 0.16694621893655154 |.
dec_mAP_pred | 0 : 0.1674840384307646 |.
dec_mAP_pred | 1 : 0.16737659850543066 |.
dec_mAP_pred | 2 : 0.16720761461944647 |.
dec_mAP_pred | 3 : 0.16706835119611593 |.
dec_mAP_pred | 4 : 0.16694286854384405 |.
dec_mAP_pred | 5 : 0.1667165492414697 |.
dec_mAP_pred | 6 : 0.1667261001434655 |.
dec_mAP_pred | 7 : 0.1664030963042301 |.
all decoder map: | 0.1670 |.
OverTaking: ap = 0.5221, cap = 0.7136
LaneChange: ap = 0.0901, cap = 0.5120
WrongLane: ap = 0.0467, cap = 0.5716
Cutting: ap = 0.0184, cap = 0.5988
(4, 181947)
(4, 181947)
[Epoch-10] [IDU-Anet2016_feature_v2] mAP: 0.1736 cAP: 0.6224

dec_mAP all together: | 0.17274385786277488 |.
dec_mAP_pred | 0 : 0.17350140732856567 |.
dec_mAP_pred | 1 : 0.1732916624264859 |.
dec_mAP_pred | 2 : 0.17309207675674626 |.
dec_mAP_pred | 3 : 0.17299571262758714 |.
dec_mAP_pred | 4 : 0.17276608593316442 |.
dec_mAP_pred | 5 : 0.17250717094581688 |.
dec_mAP_pred | 6 : 0.1723070549310653 |.
dec_mAP_pred | 7 : 0.17206917218965273 |.
all decoder map: | 0.1728 |.
OverTaking: ap = 0.5021, cap = 0.6883
LaneChange: ap = 0.1099, cap = 0.5619
WrongLane: ap = 0.0498, cap = 0.5794
Cutting: ap = 0.0328, cap = 0.6600python custom_main.py
lr:0.0001
batch_size:128
weight_decay:0.0001
epochs:20
resize_feature:False
lr_drop:1
clip_max_norm:1.0
dataparallel:False
removelog:False
version:v3
query_num:8
decoder_layers:6
decoder_embedding_dim:1024
decoder_embedding_dim_out:1024
decoder_attn_dropout_rate:0.1
decoder_num_heads:4
classification_pred_loss_coef:0.5
enc_layers:64
lr_backbone:0.0001
feature:Anet2016_feature_v2
dim_feature:4096
patch_dim:1
embedding_dim:1024
num_heads:8
num_layers:4
attn_dropout_rate:0.1
positional_encoding_type:learned
hidden_dim:4096
dropout_rate:0.1
numclass:4
classification_x_loss_coef:0.3
classification_h_loss_coef:1
similar_loss_coef:0.1
margin:1.0
weighted_loss:False
dataset_file:../../../pvc-meteor/features/METEOR_info.json
frozen_weights:None
thumos_data_path:/home/dancer/mycode/Temporal.Online.Detection/Online.TRN.Pytorch/preprocess/
thumos_anno_path:data/thumos_{}_anno.pickle
remove_difficult:False
device:cuda
binary_label:False
output_dir:experiments/enc_layers_4_dec_layers_6
seed:20
resume:experiments/enc_layers_4_dec_layers_6/checkpoint.pth
start_epoch:1
eval:False
num_workers:8
use_frequent:True
use_infrequent:False
world_size:1
dist_url:tcp://127.0.0.1:12342
all_class_name:['OverTaking', 'LaneChange', 'WrongLane', 'Cutting']
distributed:False
number of params: 117681160
(4, 181947)
(4, 181947)
[Epoch-11] [IDU-Anet2016_feature_v2] mAP: 0.1554 cAP: 0.5741

dec_mAP all together: | 0.15234373848021765 |.
dec_mAP_pred | 0 : 0.15279594604529398 |.
dec_mAP_pred | 1 : 0.15258925643129545 |.
dec_mAP_pred | 2 : 0.15248330244722616 |.
dec_mAP_pred | 3 : 0.15252704452798135 |.
dec_mAP_pred | 4 : 0.15235038374277837 |.
dec_mAP_pred | 5 : 0.15217779412360435 |.
dec_mAP_pred | 6 : 0.15208077758949126 |.
dec_mAP_pred | 7 : 0.15210759152589723 |.
all decoder map: | 0.1524 |.
OverTaking: ap = 0.4620, cap = 0.6611
LaneChange: ap = 0.0989, cap = 0.5364
WrongLane: ap = 0.0390, cap = 0.5380
Cutting: ap = 0.0216, cap = 0.5610
(4, 181947)
(4, 181947)
[Epoch-12] [IDU-Anet2016_feature_v2] mAP: 0.1587 cAP: 0.5754

dec_mAP all together: | 0.15643379485161515 |.
dec_mAP_pred | 0 : 0.15669184551347587 |.
dec_mAP_pred | 1 : 0.1566795172192154 |.
dec_mAP_pred | 2 : 0.15656566077276726 |.
dec_mAP_pred | 3 : 0.15642449241273204 |.
dec_mAP_pred | 4 : 0.15641401367356006 |.
dec_mAP_pred | 5 : 0.156361965546982 |.
dec_mAP_pred | 6 : 0.15621407391401892 |.
dec_mAP_pred | 7 : 0.15645232394201658 |.
all decoder map: | 0.1565 |.
OverTaking: ap = 0.4939, cap = 0.6914
LaneChange: ap = 0.0829, cap = 0.4894
WrongLane: ap = 0.0417, cap = 0.5506
Cutting: ap = 0.0163, cap = 0.5700
(4, 181947)
(4, 181947)
[Epoch-13] [IDU-Anet2016_feature_v2] mAP: 0.1603 cAP: 0.5868

dec_mAP all together: | 0.15825866754372048 |.
dec_mAP_pred | 0 : 0.15972322936135078 |.
dec_mAP_pred | 1 : 0.1592780246020426 |.
dec_mAP_pred | 2 : 0.15871839664245235 |.
dec_mAP_pred | 3 : 0.15842102308320447 |.
dec_mAP_pred | 4 : 0.15808281113289427 |.
dec_mAP_pred | 5 : 0.15780132457942125 |.
dec_mAP_pred | 6 : 0.15754394826061227 |.
dec_mAP_pred | 7 : 0.15732834665771944 |.
all decoder map: | 0.1584 |.
OverTaking: ap = 0.4774, cap = 0.6735
LaneChange: ap = 0.0945, cap = 0.5242
WrongLane: ap = 0.0381, cap = 0.5348
Cutting: ap = 0.0312, cap = 0.6145
(4, 181947)
(4, 181947)
[Epoch-14] [IDU-Anet2016_feature_v2] mAP: 0.1610 cAP: 0.5735

dec_mAP all together: | 0.16004303596328112 |.
dec_mAP_pred | 0 : 0.161112805983351 |.
dec_mAP_pred | 1 : 0.16090724350213814 |.
dec_mAP_pred | 2 : 0.16050840521932072 |.
dec_mAP_pred | 3 : 0.16029024685918455 |.
dec_mAP_pred | 4 : 0.16008845682576778 |.
dec_mAP_pred | 5 : 0.15963623968086738 |.
dec_mAP_pred | 6 : 0.15931467827708293 |.
dec_mAP_pred | 7 : 0.15906737217061942 |.
all decoder map: | 0.1601 |.
OverTaking: ap = 0.4970, cap = 0.6914
LaneChange: ap = 0.0825, cap = 0.4881
WrongLane: ap = 0.0390, cap = 0.5401
Cutting: ap = 0.0253, cap = 0.5743
(4, 181947)
(4, 181947)
[Epoch-15] [IDU-Anet2016_feature_v2] mAP: 0.1506 cAP: 0.5840

dec_mAP all together: | 0.15055288028173308 |.
dec_mAP_pred | 0 : 0.15142178736635972 |.
dec_mAP_pred | 1 : 0.15125024511072627 |.
dec_mAP_pred | 2 : 0.15090906321982023 |.
dec_mAP_pred | 3 : 0.15070094699472575 |.
dec_mAP_pred | 4 : 0.1505560699274622 |.
dec_mAP_pred | 5 : 0.15028754833759098 |.
dec_mAP_pred | 6 : 0.1499086061661649 |.
dec_mAP_pred | 7 : 0.1496998608972007 |.
all decoder map: | 0.1506 |.
OverTaking: ap = 0.4423, cap = 0.6431
LaneChange: ap = 0.0947, cap = 0.5257
WrongLane: ap = 0.0410, cap = 0.5520
Cutting: ap = 0.0243, cap = 0.6152
(4, 181947)
(4, 181947)
[Epoch-16] [IDU-Anet2016_feature_v2] mAP: 0.1587 cAP: 0.5859

dec_mAP all together: | 0.15853140900529095 |.
dec_mAP_pred | 0 : 0.15930732592642782 |.
dec_mAP_pred | 1 : 0.15916634163872473 |.
dec_mAP_pred | 2 : 0.1589101341479378 |.
dec_mAP_pred | 3 : 0.15862877742734 |.
dec_mAP_pred | 4 : 0.1584029082098675 |.
dec_mAP_pred | 5 : 0.15823270884606294 |.
dec_mAP_pred | 6 : 0.15815229898084857 |.
dec_mAP_pred | 7 : 0.15809287853016646 |.
all decoder map: | 0.1586 |.
OverTaking: ap = 0.4847, cap = 0.6801
LaneChange: ap = 0.0856, cap = 0.4985
WrongLane: ap = 0.0400, cap = 0.5438
Cutting: ap = 0.0244, cap = 0.6214
(4, 181947)
(4, 181947)
[Epoch-17] [IDU-Anet2016_feature_v2] mAP: 0.1557 cAP: 0.5715

dec_mAP all together: | 0.15511860965269736 |.
dec_mAP_pred | 0 : 0.15618645729957545 |.
dec_mAP_pred | 1 : 0.15589556387807896 |.
dec_mAP_pred | 2 : 0.1555940269951124 |.
dec_mAP_pred | 3 : 0.15526256538699254 |.
dec_mAP_pred | 4 : 0.15511028192868911 |.
dec_mAP_pred | 5 : 0.15475033350080608 |.
dec_mAP_pred | 6 : 0.15434838460885855 |.
dec_mAP_pred | 7 : 0.1539975887161923 |.
all decoder map: | 0.1551 |.
OverTaking: ap = 0.4819, cap = 0.6778
LaneChange: ap = 0.0884, cap = 0.5069
WrongLane: ap = 0.0359, cap = 0.5202
Cutting: ap = 0.0167, cap = 0.5812
(4, 181947)
(4, 181947)
[Epoch-18] [IDU-Anet2016_feature_v2] mAP: 0.1468 cAP: 0.5639

dec_mAP all together: | 0.1462714830661494 |.
dec_mAP_pred | 0 : 0.14712630396758078 |.
dec_mAP_pred | 1 : 0.1469199601149831 |.
dec_mAP_pred | 2 : 0.1466278071283946 |.
dec_mAP_pred | 3 : 0.14639237105733058 |.
dec_mAP_pred | 4 : 0.1461300941177544 |.
dec_mAP_pred | 5 : 0.14590808710574787 |.
dec_mAP_pred | 6 : 0.1457078832897261 |.
dec_mAP_pred | 7 : 0.14563905547177122 |.
all decoder map: | 0.1463 |.
OverTaking: ap = 0.4405, cap = 0.6442
LaneChange: ap = 0.0918, cap = 0.5169
WrongLane: ap = 0.0352, cap = 0.5151
Cutting: ap = 0.0199, cap = 0.5793
(4, 181947)
(4, 181947)
[Epoch-19] [IDU-Anet2016_feature_v2] mAP: 0.1542 cAP: 0.5663

dec_mAP all together: | 0.15430991962250698 |.
dec_mAP_pred | 0 : 0.15512547197813 |.
dec_mAP_pred | 1 : 0.15496914931657446 |.
dec_mAP_pred | 2 : 0.15471543200025206 |.
dec_mAP_pred | 3 : 0.1545194259263348 |.
dec_mAP_pred | 4 : 0.15422792935431673 |.
dec_mAP_pred | 5 : 0.15395944988461646 |.
dec_mAP_pred | 6 : 0.15371336182632656 |.
dec_mAP_pred | 7 : 0.15356046428899492 |.
all decoder map: | 0.1543 |.
OverTaking: ap = 0.4804, cap = 0.6792
LaneChange: ap = 0.0856, cap = 0.4983
WrongLane: ap = 0.0365, cap = 0.5249
Cutting: ap = 0.0142, cap = 0.5629
