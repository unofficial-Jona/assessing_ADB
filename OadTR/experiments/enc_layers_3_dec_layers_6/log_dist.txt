python custom_experiments.py
lr:0.0001
batch_size:256
weight_decay:0.0001
epochs:11
resize_feature:False
lr_drop:20
clip_max_norm:1.0
dataparallel:False
removelog:False
version:v3
query_num:8
decoder_layers:6
decoder_embedding_dim:1024
decoder_embedding_dim_out:1024
decoder_attn_dropout_rate:0.1
decoder_num_heads:4
classification_pred_loss_coef:0.5
enc_layers:64
lr_backbone:0.0001
feature:Anet2016_feature_v2
dim_feature:4096
patch_dim:1
embedding_dim:1024
num_heads:8
num_layers:3
attn_dropout_rate:0.1
positional_encoding_type:learned
hidden_dim:4096
dropout_rate:0.1
numclass:4
classification_x_loss_coef:0.3
classification_h_loss_coef:1
similar_loss_coef:0.1
margin:1.0
dataset_file:../../../pvc-meteor/features/METEOR_info.json
frozen_weights:None
thumos_data_path:/home/dancer/mycode/Temporal.Online.Detection/Online.TRN.Pytorch/preprocess/
thumos_anno_path:data/thumos_{}_anno.pickle
remove_difficult:False
device:cuda
binary_label:False
output_dir:models/experiments/enc_layers_3_dec_layers_6
seed:20
resume:
start_epoch:1
eval:False
num_workers:8
use_frequent:True
use_infrequent:False
world_size:1
dist_url:tcp://127.0.0.1:12342
all_class_name:['OverTaking', 'LaneChange', 'WrongLane', 'Cutting']
distributed:False
number of params: 105088008
(4, 181947)
(4, 181947)
[Epoch-1] [IDU-Anet2016_feature_v2] mAP: 0.2141 cAP: 0.6561

dec_mAP all together: | 0.21379254130965514 |.
dec_mAP_pred | 0 : 0.21541754683914893 |.
dec_mAP_pred | 1 : 0.2149504143316826 |.
dec_mAP_pred | 2 : 0.21455196779329064 |.
dec_mAP_pred | 3 : 0.21404426999377954 |.
dec_mAP_pred | 4 : 0.2135622721645798 |.
dec_mAP_pred | 5 : 0.2131345349120484 |.
dec_mAP_pred | 6 : 0.21273329554386738 |.
dec_mAP_pred | 7 : 0.21238142033950638 |.
all decoder map: | 0.2138 |.
OverTaking: ap = 0.6030, cap = 0.7691
LaneChange: ap = 0.1226, cap = 0.5853
WrongLane: ap = 0.0318, cap = 0.4882
Cutting: ap = 0.0990, cap = 0.7816
(4, 181947)
(4, 181947)
[Epoch-2] [IDU-Anet2016_feature_v2] mAP: 0.2212 cAP: 0.6765

dec_mAP all together: | 0.22032264283780126 |.
dec_mAP_pred | 0 : 0.2219788793494928 |.
dec_mAP_pred | 1 : 0.2216479947629012 |.
dec_mAP_pred | 2 : 0.22112532480914657 |.
dec_mAP_pred | 3 : 0.2206603814320235 |.
dec_mAP_pred | 4 : 0.22015573453107817 |.
dec_mAP_pred | 5 : 0.21966372341275275 |.
dec_mAP_pred | 6 : 0.21924231963459695 |.
dec_mAP_pred | 7 : 0.2187516768129599 |.
all decoder map: | 0.2204 |.
OverTaking: ap = 0.6051, cap = 0.7733
LaneChange: ap = 0.1030, cap = 0.5466
WrongLane: ap = 0.0583, cap = 0.6094
Cutting: ap = 0.1185, cap = 0.7766
(4, 181947)
(4, 181947)
[Epoch-3] [IDU-Anet2016_feature_v2] mAP: 0.2003 cAP: 0.6563

dec_mAP all together: | 0.1974782774967714 |.
dec_mAP_pred | 0 : 0.19857533127642557 |.
dec_mAP_pred | 1 : 0.19829179082233822 |.
dec_mAP_pred | 2 : 0.19800074435140125 |.
dec_mAP_pred | 3 : 0.19772708232140604 |.
dec_mAP_pred | 4 : 0.19741985543046653 |.
dec_mAP_pred | 5 : 0.19713076518132308 |.
dec_mAP_pred | 6 : 0.1968269555661668 |.
dec_mAP_pred | 7 : 0.1965082153129708 |.
all decoder map: | 0.1976 |.
OverTaking: ap = 0.6009, cap = 0.7702
LaneChange: ap = 0.0948, cap = 0.5251
WrongLane: ap = 0.0568, cap = 0.5962
Cutting: ap = 0.0486, cap = 0.7337
(4, 181947)
(4, 181947)
[Epoch-4] [IDU-Anet2016_feature_v2] mAP: 0.1886 cAP: 0.6184

dec_mAP all together: | 0.1846912645066721 |.
dec_mAP_pred | 0 : 0.18529746088499882 |.
dec_mAP_pred | 1 : 0.18514164272437555 |.
dec_mAP_pred | 2 : 0.18493877296214237 |.
dec_mAP_pred | 3 : 0.1848030898873191 |.
dec_mAP_pred | 4 : 0.18464756596945048 |.
dec_mAP_pred | 5 : 0.18450635360934878 |.
dec_mAP_pred | 6 : 0.1843476616056273 |.
dec_mAP_pred | 7 : 0.18423533609567053 |.
all decoder map: | 0.1847 |.
OverTaking: ap = 0.5570, cap = 0.7388
LaneChange: ap = 0.0897, cap = 0.5107
WrongLane: ap = 0.0494, cap = 0.5724
Cutting: ap = 0.0585, cap = 0.6518
(4, 181947)
(4, 181947)
[Epoch-5] [IDU-Anet2016_feature_v2] mAP: 0.1840 cAP: 0.6480

dec_mAP all together: | 0.18226948511722446 |.
dec_mAP_pred | 0 : 0.18326851135755381 |.
dec_mAP_pred | 1 : 0.1829883130739254 |.
dec_mAP_pred | 2 : 0.18273227940578787 |.
dec_mAP_pred | 3 : 0.18249290304449883 |.
dec_mAP_pred | 4 : 0.18218308321465637 |.
dec_mAP_pred | 5 : 0.18190760523757157 |.
dec_mAP_pred | 6 : 0.1816507246850817 |.
dec_mAP_pred | 7 : 0.18139851557125608 |.
all decoder map: | 0.1823 |.
OverTaking: ap = 0.5391, cap = 0.7204
LaneChange: ap = 0.1079, cap = 0.5586
WrongLane: ap = 0.0570, cap = 0.6102
Cutting: ap = 0.0322, cap = 0.7028
(4, 181947)
(4, 181947)
[Epoch-6] [IDU-Anet2016_feature_v2] mAP: 0.1831 cAP: 0.6378

dec_mAP all together: | 0.1816455587357943 |.
dec_mAP_pred | 0 : 0.18295426033299106 |.
dec_mAP_pred | 1 : 0.18257162637512908 |.
dec_mAP_pred | 2 : 0.18218104364533766 |.
dec_mAP_pred | 3 : 0.18193231065852342 |.
dec_mAP_pred | 4 : 0.18157646489863394 |.
dec_mAP_pred | 5 : 0.18122320655500831 |.
dec_mAP_pred | 6 : 0.18086121969777108 |.
dec_mAP_pred | 7 : 0.18056479161833086 |.
all decoder map: | 0.1817 |.
OverTaking: ap = 0.5235, cap = 0.7077
LaneChange: ap = 0.1069, cap = 0.5552
WrongLane: ap = 0.0566, cap = 0.6010
Cutting: ap = 0.0455, cap = 0.6873
(4, 181947)
(4, 181947)
[Epoch-7] [IDU-Anet2016_feature_v2] mAP: 0.1752 cAP: 0.6114

dec_mAP all together: | 0.17312867532784262 |.
dec_mAP_pred | 0 : 0.17389306701312873 |.
dec_mAP_pred | 1 : 0.1736832734502744 |.
dec_mAP_pred | 2 : 0.1735296380555164 |.
dec_mAP_pred | 3 : 0.17332634638572797 |.
dec_mAP_pred | 4 : 0.17309356432705747 |.
dec_mAP_pred | 5 : 0.17290799476246194 |.
dec_mAP_pred | 6 : 0.1727102939800425 |.
dec_mAP_pred | 7 : 0.17251846375995164 |.
all decoder map: | 0.1732 |.
OverTaking: ap = 0.5298, cap = 0.7184
LaneChange: ap = 0.0964, cap = 0.5300
WrongLane: ap = 0.0478, cap = 0.5697
Cutting: ap = 0.0269, cap = 0.6273
(4, 181947)
(4, 181947)
[Epoch-8] [IDU-Anet2016_feature_v2] mAP: 0.1790 cAP: 0.6316

dec_mAP all together: | 0.17748007353562534 |.
dec_mAP_pred | 0 : 0.17834381473007702 |.
dec_mAP_pred | 1 : 0.17814123895659523 |.
dec_mAP_pred | 2 : 0.17792982708258412 |.
dec_mAP_pred | 3 : 0.17769535012933604 |.
dec_mAP_pred | 4 : 0.17745634419041673 |.
dec_mAP_pred | 5 : 0.17725343860586615 |.
dec_mAP_pred | 6 : 0.17696112182254073 |.
dec_mAP_pred | 7 : 0.17666226948968025 |.
all decoder map: | 0.1776 |.
OverTaking: ap = 0.5278, cap = 0.7101
LaneChange: ap = 0.1002, cap = 0.5398
WrongLane: ap = 0.0547, cap = 0.5987
Cutting: ap = 0.0332, cap = 0.6779
(4, 181947)
(4, 181947)
[Epoch-9] [IDU-Anet2016_feature_v2] mAP: 0.1741 cAP: 0.6050

dec_mAP all together: | 0.17171002204590005 |.
dec_mAP_pred | 0 : 0.1725824789392848 |.
dec_mAP_pred | 1 : 0.1723186632786545 |.
dec_mAP_pred | 2 : 0.17215398972265974 |.
dec_mAP_pred | 3 : 0.17192833868163218 |.
dec_mAP_pred | 4 : 0.17167780916234637 |.
dec_mAP_pred | 5 : 0.17139760903679882 |.
dec_mAP_pred | 6 : 0.17111783637949635 |.
dec_mAP_pred | 7 : 0.17094758441672722 |.
all decoder map: | 0.1718 |.
OverTaking: ap = 0.5277, cap = 0.7135
LaneChange: ap = 0.0965, cap = 0.5291
WrongLane: ap = 0.0471, cap = 0.5655
Cutting: ap = 0.0250, cap = 0.6117
(4, 181947)
(4, 181947)
[Epoch-10] [IDU-Anet2016_feature_v2] mAP: 0.1689 cAP: 0.6039

dec_mAP all together: | 0.1668598282381982 |.
dec_mAP_pred | 0 : 0.16762098013501972 |.
dec_mAP_pred | 1 : 0.1674087781202805 |.
dec_mAP_pred | 2 : 0.16720825597122604 |.
dec_mAP_pred | 3 : 0.16691320955494388 |.
dec_mAP_pred | 4 : 0.16678565693955474 |.
dec_mAP_pred | 5 : 0.16658982901012614 |.
dec_mAP_pred | 6 : 0.1663825240007377 |.
dec_mAP_pred | 7 : 0.16628999576795914 |.
all decoder map: | 0.1669 |.
OverTaking: ap = 0.5053, cap = 0.6949
LaneChange: ap = 0.1004, cap = 0.5388
WrongLane: ap = 0.0474, cap = 0.5757
Cutting: ap = 0.0223, cap = 0.6062
